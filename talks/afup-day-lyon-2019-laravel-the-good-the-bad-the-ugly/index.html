<!doctype html>
<html lang="en">

    <head>
        <meta charset="utf-8">

        <title>Laravel : the good, the bad and the uglyâ€¦ - AFUP Day Lyon 2019 - StÃ©phane HULARD / CHStudio</title>

        <meta name="description" content="En France Laravel fait l'objet de troll, et de critiques sur les patterns utilisÃ©s et l'approche technique de son crÃ©ateur Taylor Otwell. La communautÃ© grandit et de plus en plus de dÃ©veloppeurs sont amenÃ©s Ã  travailler sur ce framework. Comme pour n'importe quel outil, il faut apprendre Ã  s'en servir !">
        <meta name="author" content="StÃ©phane HULARD">

        <meta name="apple-mobile-web-app-capable" content="yes" />
        <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />

        <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">

        <link rel="stylesheet" href="../assets/reveal.js/css/reveal.css">
        <link rel="stylesheet" href="../assets/css/font-awesome.min.css">
        <link rel="stylesheet" href="../assets/css/theme.css" id="theme">

        <!-- For syntax highlighting -->
        <link rel="stylesheet" href="../assets/css/tomorrow.css">

        <style type="text/css">
            .reveal .social-me {
                float: right;
            }
            .reveal .social-me img {
                margin-bottom: 0px;
            }
            .reveal .social-me a {
                color: #FFF;
                margin-right: 10px;
            }
            .reveal .social-me a:hover {
                color: rgba(4, 32, 41, 0.9);
            }
            .reveal .social-me a:last-child {
                margin-right: 0;
            }
            .right {
                text-align: right;
            }
            .bottom {
                margin-top: 35% !important;
            }
            .top {
                margin-bottom: 35% !important;
            }
            .left {
                text-align: left;
            }
            .float-right {
                float: right;
            }
            .background {
                background-color: rgba(255, 255, 255, 0.9) !important;
            }
            .no-background {
                background: none !important;
            }
            .border-radius {
                border-radius: 20px;
            }
            code.fragment {
                padding: 12px;
            }
            .full-height {
                max-height: unset !important;
            }
            .reveal {
                background-color: rgba(0, 174, 239, 0.8);
            }
            .reveal h1.highlight *, .reveal p.highlight>* {
                background-color: rgba(4, 32, 41, 0.9);
                display: inline;
                padding-left: 15px;
                padding-right: 15px;
            }
            .reveal h1.highlight *:last-child {
                line-height: 2em
            }
            .reveal section>p {
                font-size: 1.2em;
            }
            .reveal section>a>img.plain {
                margin: 23px 0;
                height: 94px;
            }
            .reveal section>a+a>img.plain {
                margin-right: 10px;
            }
            .reveal section.invert {
                color: rgba(0, 0, 0, 0.8);
            }
            .reveal pre {
                font-size: 2rem;
            }
            .reveal pre code {
                padding: 1rem 1.5rem;
            }

            .reveal section.invert p.highlight>* {
                background-color: rgba(255, 255, 255, 0.9)
            }
            .speaker-controls-notes .value {
                font-size: 1em !important;
            }

            .reveal .slide-background.present {
                opacity: 0.9;
            }

            .light-background .reveal .slide-background.present {
                opacity: 0.6;
            }

            .relative {
                position: relative;
            }
            .absolute {
                position: absolute !important;
                top: 0;
                left: 0;
            }
        </style>

        <!-- Printing and PDF exports -->
        <script>
            var link = document.createElement( 'link' );
            link.rel = 'stylesheet';
            link.type = 'text/css';
            link.href = window.location.search.match( /print-pdf/gi ) ? '../assets/reveal.js/css/print/pdf.css' : '../assets/reveal.js/css/print/paper.css';
            document.getElementsByTagName( 'head' )[0].appendChild( link );
        </script>

        <!--[if lt IE 9]>
        <script src="../assets/reveal.js/lib/js/html5shiv.js"></script>
        <![endif]-->
    </head>

    <body>

        <div class="reveal concave center">
            <div class="slides">
                <section data-background-image="img/good-bad-ugly.jpg">
                    <h1 class="highlight" style="font-size: 3.5em;"><span>Laravel</span></h1>
                    <p class="global-footer">
                        <a href="https://chstudio.fr"><img src="../../logo.png" width="20" class="plain" /></a>
                        <a href="https://afup.org"><img src="img/afup.png" width="20" class="plain" /></a>
                        <span><time datetime="2019-05-17">2019</time>&nbsp;-&nbsp;AFUP Day Lyon / Laravel : the good, the bad and the uglyâ€¦</span>
                    </p>
                    <aside class="notes">
                        Bonjour, et bienvenue Ã  cette confÃ©rence sur Laravel. Je vais essayer durant les 40 prochaines minutes de vous faire dÃ©couvrir cet outil, ses principales forces et faiblesses. Tout Ã§a est bien sur complÃ¨tement sujectif !<br/>
                        Pour Ãªtre sur que tout le monde va repartir avec la vision la plus claire possible, je ponctuerai d'exemple et de code pour illustrer mes propos.<br/>
                        Nous allons voir du code moche, mais surtout nous allons voir comment l'embellir, Ã  la sauce Laravel bien sur !
                    </aside>
                </section>
                <section class="invert">
                    <p class="social-me">
                        <img src="img/moi.jpg" class="plain" width="250"/><br/>
                        <a class="white" target="_blank" href="https://twitter.com/s_hulard">@s_hulard</a><br/>
                        <a class="white" target="_blank" href="https://chstudio.fr"><i class="fa fa-globe"></i></a>
                        <a class="white" target="_blank" href="https://www.linkedin.com/in/shulard"><i class="fa fa-linkedin"></i></a>
                        <a class="white" target="_blank" href="https://github.com/shulard"><i class="fa fa-github"></i></a>
                        <a class="white" target="_blank" href="https://gitlab.com/shulard"><i class="fa fa-gitlab"></i></a>
                    </p>
                    <h1 class="highlight left"><span>StÃ©phane Hulard</span></h1>
                    <p class="left highlight">
                        <span class="fragment">CTO, </span>
                        <span class="fragment">Formateur, </span>
                        <span class="fragment">Contributeur.</span>
                    </p>
                    <aside class="notes">
                        Je commence par me prÃ©senter, je suis StÃ©phane Hulard, consultant indÃ©pendant.
                        <br/>
                        â–¶ Les projets sur lesquelles j'interviens intÃ¨grent souvent des problÃ©matiques de gestion de donnÃ©es. On peut dire que ma spÃ©cialitÃ© est d'interprÃ©ter, traiter et transformer des masses de donnÃ©es pour aider mes clients Ã  les exploiter.
                        <br/>
                        Aujourd'hui je travaille principalement avec Exoskills une entreprise Lyonnaise spÃ©cialisÃ©e dans l'accompagnement Ã  la transformation digitale de ses clients. Nous sommes d'ailleurs en recherche de profil technique si vous Ãªtes interessÃ©s, n'hÃ©sitez pas Ã  venir me voir aprÃ¨s.
                        <br/>
                        J'aime aussi beaucoup travailler sur des projets legacy pour accompagner les Ã©quipes Ã  les reprendre en main.
                        <br/>
                        â–¶ Je suis aussi formateur et rÃ©fÃ©rencÃ© en tant quâ€™organisme de formation. Je forme principalement aux outils et mÃ©thodes liÃ©s Ã  la qualitÃ© logicielle : Architecture, intÃ©gration continue, dÃ©ploiement continue, testsâ€¦
                        <br/>
                        â–¶ J'adore pouvoir travailler sur des projets open source et jâ€™y consacre Ã  peu prÃªt 20% de mon temps. Bien sur c'est variable en fonction du reste et des projets clients mais Ã§a me permet d'Ã©largir ma vision du mÃ©tier en bÃ©nÃ©ficiant de lâ€™expertise et du soutien de la communautÃ© ce qui est un atout prÃ©cieux.
                    </aside>
                </section>
                <section class="stack">
                    <section data-background-image="img/laravel.svg" data-background-color="rgba(255, 255, 255, 1)">
                        <h1 class="highlight"><span>Laravel ?</span></h1>
                        <aside class="notes">
                            C'est un framework open source dÃ©veloppÃ© en PHP et crÃ©Ã© par Taylor Otwell. Il est considÃ©rÃ© comme ayant des idÃ©es arrÃªtÃ©s et est assez souvent mal vue par la communautÃ©. Je pense que ses Ã©chauffements sur Twitter y sont pour beaucoup.<br/>
                            Nous ne sommes pas ici pour parler de lui personnellement bien sur mais plutÃ´t des outils qu'il apporte Ã  la communautÃ©.
                        </aside>
                    </section>
                    <section data-background-image="img/time.jpg" class="invert left">
                        <h1 class="highlight"><span>Un peu d'histoireâ€¦</span></h1>
                        <p class="highlight">
                            <span class="fragment"><strong>2011</strong>: Premier commit,</span><br/>
                            <span class="fragment"><strong>2013</strong>: v4.0.0, </span><br/>
                            <span class="fragment"><strong>2015</strong>: v5.0.0, </span><br/>
                            <span class="fragment"><strong>2019</strong>: v5.9.0 ?</span>
                        </p>
                        <aside class="notes">
                            â–¶ Il existe depuis presque 10 ans mais il s'est crÃ©Ã© une place bien au chaud parmis les frameworks les plus populaires depuis la version 5.0, il y a 4 ans.<br/>
                            â–¶ Cette version apporte d'ailleurs un conteneur d'injection de dÃ©pendance avec du contextual binding, un des premiers outils Ã  le proposer. C'est ce qui m'a fait basculer sur Laravel Ã  cette pÃ©riode.<br/>
                            â–¶ La branche 5.0 est celle qui est active actuellement. Avec un rythme de deux releases mineures par ans, les presques 500 contributeurs du projet sont trÃ¨s actifs.<br/>
                            Il y a mÃªme aujourd'hui deux dÃ©veloppeurs payÃ©s Ã  temps plein sur le projet.
                        </aside>
                    </section>
                    <section data-background-image="img/lego.jpg" class="invert left">
                        <h1 class="highlight"><span>Des racines communesâ€¦</span></h1>
                        <p class="highlight">
                            <span class="fragment">â€¦ pour les habituÃ©s Ã  Symfony ðŸ˜Š</span>
                        </p>
                        <aside class="notes">
                            Avec la sortie de la 4.0, la structure du projet s'est professionnalisÃ©e. Une gestion de dÃ©pendances solide, un attachement Ã  l'utilisation de librairie open source de rÃ©fÃ©rence permettent une meilleure adoption de la communautÃ©.<br/>
                            Par exemple, le coeur est construit autour des composants Symfony les plus connues:<br/>
                            â–¶ HttpFoundation, HttpKernel, Console.
                        </aside>
                    </section>
                    <section data-background-image="img/layers.jpg" class="left invert">
                        <h1 class="highlight"><span>Une surcouche spÃ©cifique !</span></h1>
                        <p class="highlight"><span class="fragment">Et une documentation trÃ¨s accessibleâ€¦</span></p>
                        <aside class="notes">
                            Ce n'est pas parce qu'il est basÃ© sur les composants de Symfony que vous vous retrouverez Ã  manipuler ces objets directement. Les fonctionnalitÃ©s sont utilisÃ©es mais en Ã©tant entiÃ¨rement dÃ©corÃ©es par une vision Laravel.<br/>
                            Je trouve Ã§a particuliÃ¨rement intÃ©ressant que Laravel Ã©tende ces composants. D'abord parce que c'est un cas concret d'utilisation mais aussi parce que Ã§a montre que la roue n'est pas rÃ©inventÃ©e inutilement.<br/>
                            Bien sur on peut toujours se poser la question de l'empreinte de Symfony dans l'Ã©cosystÃ¨me PHP, il est presque partout aujourd'hui et peut Ãªtre considÃ©rÃ© en monopoleâ€¦ Mais heureusement il y a d'autres solutions qui continuent d'exister et vivre en dehors de tout Ã§a.<br/>
                            â–¶ En plus de cette couche, une documentation disponible en ligne permet d'avoir rapidement accÃ¨s aux exemples et explications utiles Ã  tout dÃ©veloppeur. Cette doc est un des gros avantages du projet, elle est simple et va Ã  l'essentiel. Tout est centralisÃ© Ã  un seul endroit et le niveau de langage utilisÃ© est trÃ¨s accessible.
                        </aside>
                    </section>
                    <section data-background-image="img/tools.jpg" class="left invert">
                        <h1 class="highlight"><span>Tout est dans la boite</span></h1>
                        <p class="highlight">
                            <span class="fragment">â–¶ composer.json</span><br/>
                            <span class="fragment">â–¶ .env</span><br/>
                            <span class="fragment">â–¶ ORM <small><code>(ActiveRecord)</code></small> + Migrations</span><br/>
                            <span class="fragment">â–¶ CLI</span><br/>
                            <span class="fragment">â–¶ Templates</span><br/>
                            <span class="fragment">â–¶ IntÃ©gration frontend <small>(<code>Elixir</code>)</small></span><br/>
                        </p>
                        <aside class="notes">
                            Laravel est un framework complet qui peut Ãªtre utilisÃ© pour travailler de maniÃ¨re efficace et dans un cadre fiable, respectant les derniÃ¨res pratiques en matiÃ¨re de dÃ©veloppement.<br/>
                            â–¶ Gestion de dÃ©pendance, â–¶ configuration par environnement, â–¶ manipulation des donnÃ©es par un modÃ¨le objet, â–¶ outil en ligne de commande pour les tÃ¢ches courantes, â–¶ langage de template, â–¶ intÃ©gration avec la couche frontend grÃ¢ce Ã  un package nommÃ© Elixir.<br/>
                            Tout ces points sont dÃ©crits dans la documentation en ligne et nous n'allons pas rentrer dans tout le dÃ©tail.<br/>
                            Bien sur, son architecture, ses dÃ©pendances, et sa philosophie lui sont propre et il faut apprendre Ã  les dÃ©couvrir et les utiliser.<br/>
                            Comme n'importe quel outil il n'apporte pas de rÃ©elle solution, seulement une approche technique. Libre Ã  l'utilisateur d'en faire quelque chose !
                        </aside>
                    </section>
                    <section data-background-image="img/building-blocks.jpg" class="left invert">
                        <h1 class="highlight"><span>Un peu de contexte</span></h1>
                        <pre>
                            <code class="bash fragment" data-trim>
# CrÃ©ation d'un projet vierge
composer create-project laravel/laravel
                            </code>
                            <code class="bash fragment" data-trim>
# DÃ©marrage du serveur web intÃ©grÃ© Ã  PHP
./artisan serve

# Homepage: http://localhost:8000
                            </code>
                        </pre>
                        <aside class="notes">
                            Nous allons maintenant rentrer dans le vif du sujet et parler de code. Pour Ãªtre sur que tout le monde soit au mÃªme niveau de comprÃ©hension, je vais dÃ©tailler la procÃ©dure d'installation d'un projet. Ce projet est construit en utilisant la version 5.8 de Laravel, qui est la version stable actuelle.<br/>
                            â–¶ Composer est utilisÃ© pour crÃ©er le squelette du projet. GrÃ¢ce aux scripts de post installation, la configuration locale est crÃ©Ã©e Ã  la volÃ©e dans un .env tout neuf.<br/>
                            â–¶ Ensuite il suffit de lancer le serveur web intÃ©grÃ© Ã  PHP pour pouvoir accÃ©der Ã  l'application depuis un navigateur.
                        </aside>
                    </section>
                    <section class="left invert">
                        <h1 class="highlight"><span>Arborescence</span></h1>
                        <div style="display: flex; background: white">
                            <pre style="width: 50%; margin: 0; font-size: 1.6rem">
                                <code class="bash" data-trim>
â”œâ”€â”€ app
â”‚Â Â  â”œâ”€â”€ Console
â”‚Â Â  â”‚Â Â  â””â”€â”€ Kernel.php
â”‚Â Â  â”œâ”€â”€ Exceptions
â”‚Â Â  â”œâ”€â”€ Http
â”‚Â Â  â”‚Â Â  â”œâ”€â”€ Controllers
â”‚Â Â  â”‚Â Â  â”œâ”€â”€ Middleware
â”‚Â Â  â”‚Â Â  â””â”€â”€ Kernel.php
â”‚Â Â  â”œâ”€â”€ Providers
â”‚Â Â  â””â”€â”€ User.php
â”œâ”€â”€ bootstrap
                                </code>
                            </pre>
                            <pre style="width: 50%; margin: 0; font-size: 1.6rem">
                                <code class="bash" data-trim>
â”œâ”€â”€ config
â”‚Â Â  â”œâ”€â”€ app.php
â”‚Â Â  â””â”€â”€ â€¦
â”œâ”€â”€ database
â”‚Â Â  â”œâ”€â”€ migations
â”‚Â Â  â”œâ”€â”€ seeds
â”œâ”€â”€ routes
â”‚Â Â  â”œâ”€â”€ api.php
â”‚Â Â  â”œâ”€â”€ web.php
â”‚Â Â  â””â”€â”€ â€¦
â”œâ”€â”€ public
â”œâ”€â”€ resources
â””â”€â”€ storages
                                </code>
                            </pre>
                        </div>
                        <aside class="notes">
                            Un petit tour d'horizon de l'arborescence de rÃ©pertoireâ€¦<br/>
                            On peut noter qu'elle est plutÃ´t standard par rapport Ã  ce qui se fait aujourd'hui. Tout le code applicatif se trouve dans le dossier `app` qui porte plutÃ´t bien son nom.<br/>
                            Une notion un peut diffÃ©rente est le terme `Providers`. Ce sont les objets qui vont contenir la configuration du conteneur d'injection de dÃ©pendances et des diffÃ©rents services. On aura par exemple le RouteServiceProvider pour le routing, EventServiceProvider pour les Ã©vÃ¨nements applicatifsâ€¦<br/>
                            La dÃ©finition des routes et de la configuration gÃ©nÃ©rale est entiÃ¨rement faite en PHP.<br/>
                            Les prochaines slides vont mentionner du code, avec les noms de fichiers ci-dessus, nous allons principalement naviguer entre les dossiers routes et app.<br/>
                            J'ai choisit de vous montrer comment gÃ©rer un upload de fichier.
                        </aside>
                    </section>
                </section>
                <section class="stack">
                    <section data-background-image="img/ugly.png" class="left invert">
                        <aside class="notes">
                            Nous commenÃ§ons par le plus terribleâ€¦<br/>
                            Tout le code prÃ©sentÃ© fonctionne et est utilisable dans une application mais il n'est pas toujours idÃ©al. Tout est toujours une question de choix, disons que l'objectif est d'avoir un code comprÃ©hensible et maintenable dans le temps.
                        </aside>
                    </section>
                    <section class="left invert">
                        <h1 class="highlight"><span>Une premiÃ¨re version</span></h1>
                        <pre>
                            <code class="php" data-line-numbers>//routes/api.php
Route::post('/upload', function() {
    request('image')->store('images');
});
                            </code>
                        </pre>
                        <aside class="notes">
                            Certains prennent surement un peu peur, mais oui, il suffit de ces trois lignes pour gÃ©rer un upload de fichier et son stockage dans un dossier "images" quelque part.<br/>
                            Bien sur il manque pas mal de vÃ©rifications pour que ce code soit complÃ¨tement viable mais nous verrons Ã§a dans la suite.<br/>
                            Je m'attarde un peu sur ces quelques lignes.<br/>
                        </aside>
                    </section>
                    <section class="left invert">
                        <h1 class="highlight"><span>Facades <small>ðŸ¤”</small></span></h1>
                        <pre>
                            <code class="php">Route::post('/upload', function() {
    ...
});</code>
                        </pre>
                        <aside class="notes">
                            On voit que la route est dÃ©finie Ã  l'aide d'une fonction statique, il s'agit des fameuses facades de Laravel. Pour ceux qui n'en ont pas entendu parler, ces sont des proxy vers des services dÃ©clarÃ©s dans le coeur de l'application.<br/>
                            Pour la dÃ©claration des routes c'est pratique, pour le reste je prÃ©fÃ¨re les Ã©viter au maximum !<br/>
                            Ensuite, on peut voir que le code exÃ©cutÃ© est dÃ©clarÃ© sous la forme d'une fonction anonyme sans paramÃ¨tre, on est sur le plus basique possible.<br/>
                            Enfin la fonction `request`, c'est pour moi le pire. Cette fonction cache un appel direct au conteneur pour rÃ©cupÃ©rer l'instance courante de `Request` ensuite, elle lit le contenu de la clÃ© 'image' et nous retourne son contenu. Ici, par change il s'agit d'un object UploadedFileâ€¦
                        </aside>
                    </section>
                    <section class="left invert">
                        <h1 class="highlight"><span>Helpers <small>ðŸ˜±</small></span></h1>
                        <pre>
                            <code class="php">/** @var UploadedFile */
request('image')->store('images');</code>
                        </pre>
                        <aside class="notes">
                            Enfin la fonction `request`, c'est pour moi le pire. Cette fonction cache un appel direct au conteneur pour rÃ©cupÃ©rer l'instance courante de requÃªte. Dedans elle le contenu de la clÃ© 'image' et nous retourne son contenu. Ici, par chance il s'agit d'un objet UploadedFile qui dispose d'une mÃ©thode "store" et donc mon code fonctionne.<br/>
                            Je dis bien par chance, ici rien n'assure que la clÃ© 'image' existe ou est bien un fichier uploadÃ©.<br/>
                            Ces helpers sont Ã  Ã©viter absolument. Trop de comportement cachÃ©s, les diffÃ©rentes couches de l'application sont complÃ¨tement transpercÃ©es pour rÃ©cupÃ©rer ce dont nous avons besoin.<br/>
                            Heureusement, il y a d'autres solutions pour arriver Ã  ce rÃ©sultat.
                        </aside>
                    </section>
                </section>
                <section class="stack">
                    <section data-background-image="img/bad.png" class="left invert">
                        <p class="highlight bottom">
                            <span class="fragment">Not so badâ€¦</span><br/>
                            <span class="fragment">â€¦l'amÃ©lioration continue !</span>
                        </p>
                        <aside class="notes"></aside>
                    </section>
                    <section class="left invert">
                        <h1 class="highlight"><span>Injection</span></h1>
                        <pre style="font-size: 1.5rem">
                            <code class="php" data-line-numbers="1,3,4">use Illuminate\Http\Request;

Route::post('/upload', function(Request $request) {
    $request
        ->file('image')
        ->store('images');
});
                            </code>
                        </pre>
                        <aside class="notes">
                        </aside>
                    </section>
                    <section class="left invert">
                        <h1 class="highlight"><span>Validation</span></h1>
                        <pre style="font-size: 1.5rem">
                            <code class="php" data-line-numbers="2-4">Route::post('/upload', function(Request $request) {
    $request->validate([
        'image' => 'required|image'
    ]);

    $request->file('image')->store('images');
});
                            </code>
                        </pre>
                        <aside class="notes">
                        </aside>
                    </section>
                    <section class="left invert">
                        <h1 class="highlight"><span>Contrats</span></h1>
                        <pre style="font-size: 1.5rem">
                            <code class="php" data-line-numbers="1,5,8-12">use Illuminate\Contracts\Filesystem\Filesystem;

Route::post(
    '/upload',
    function(Request $request, Filesystem $filesystem) {
        //[...] Validation

        $file = $request->file('image');
        $filesystem->put(
            sprintf('images/%s', $file->hashName()),
            $file
        );
    }
);
                            </code>
                        </pre>
                        <aside class="notes">
                        </aside>
                    </section>
                </section>
                <section class="stack">
                    <section data-background-image="img/good.png" class="left invert">
                        <aside class="notes"></aside>
                    </section>
                    <section class="left invert" data-background-image="img/separation-of-concerns.jpg" data-state="light-background">
                        <h1 class="highlight"><span>Separation of concerns</span></h1>
                        <p class="highlight"><span class="fragment">Chaque chose Ã  sa placeâ€¦</span></p>
                        <p class="highlight right"><span class="fragment">â€¦ContrÃ´leur, </span><span class="fragment">Route, </span><span class="fragment">Service.</span></p>
                        <aside class="notes">
                        </aside>
                    </section>
                    <section class="left invert">
                        <h1 class="highlight"><span>ContrÃ´leur</span></h1>
                        <div class="relative">
                            <pre style="font-size: 1.5rem" class="absolute">
                                <code class="php" data-line-numbers>namespace App\Http\Controllers\Api\User;

class UploadProfilePicture
{
    private $filesystem;

    public function __construct(Filesystem $filesystem) {
        $this->filesystem = $filesystem;
    }

    public function __invoke(Request $request) {
        // ... Action code
    }
}
                                </code>
                            </pre>
                            <pre style="font-size: 1.5rem" class="fragment absolute fade-in">
                                <code class="php" data-line-numbers="5,7-9">namespace App\Http\Controllers\Api\User;

class UploadProfilePicture
{
    private $filesystem;

    public function __construct(Filesystem $filesystem) {
        $this->filesystem = $filesystem;
    }

    public function __invoke(Request $request) {
        // ... Action code
    }
}
                                </code>
                            </pre>
                            <pre style="font-size: 1.5rem" class="fragment absolute fade-in">
                                <code class="php" data-line-numbers="11-13">namespace App\Http\Controllers\Api\User;

class UploadProfilePicture
{
    private $filesystem;

    public function __construct(Filesystem $filesystem) {
        $this->filesystem = $filesystem;
    }

    public function __invoke(Request $request) {
        // ... Action code
    }
}
                                </code>
                            </pre>
                        </div>
                        <aside class="notes">
                        </aside>
                    </section>
                    <section class="left invert">
                        <h1 class="highlight"><span>Route</span></h1>
                        <pre>
                            <code class="php" data-line-numbers="">Route::post(
    '/upload',
    'Api\User\UploadProfilePicture'
);
                            </code>
                        </pre>
                        <aside class="notes">
                        </aside>
                    </section>
                    <section class="left invert" data-background-image="img/container.jpg" data-state="light-background">
                        <h1 class="highlight"><span>Services et conteneur</span></h1>
                        <p class="highlight"><span class="fragment">Les services sont des objetsâ€¦</span></p>
                        <p class="highlight right"><span class="fragment">â€¦ construits et gÃ©rÃ©s par le conteneur â€¦</span></p>
                        <p class="highlight"><span class="fragment">â€¦ injectÃ©s Ã  l'exÃ©cution.</span></p>
                        <aside class="notes">
                        </aside>
                    </section>
                    <section class="left invert">
                        <h1 class="highlight"><span>DÃ©finition <small><code>AppServiceProvider::boot</code></small></span></h1>
                        <div class="relative">
                            <pre style="font-size: 1.5rem" class="absolute">
                                <code class="php" data-line-numbers="">use Illuminate\Contracts\Filesystem\Filesystem;
use Illuminate\Filesystem\FilesystemManager;
use Illuminate\Foundation\Application;

$this->app->bind(
    Filesystem::class,
    function(Application $app) {
        return $app
            ->make(FilesystemManager::class)
            ->disk('local');
    }
);
                                </code>
                            </pre>
                            <pre style="font-size: 1.5rem" class="fragment fade-in absolute">
                                <code class="php" data-line-numbers="5-12">use Illuminate\Contracts\Filesystem\Filesystem;
use Illuminate\Filesystem\FilesystemManager;
use Illuminate\Foundation\Application;

$this->app->bind(
    Filesystem::class,
    function(Application $app) {
        return $app
            ->make(FilesystemManager::class)
            ->disk('local');
    }
);
                                </code>
                            </pre>
                            <pre style="font-size: 1.5rem" class="fragment fade-in absolute">
                                <code class="php" data-line-numbers="8-10">use Illuminate\Contracts\Filesystem\Filesystem;
use Illuminate\Filesystem\FilesystemManager;
use Illuminate\Foundation\Application;

$this->app->bind(
    Filesystem::class,
    function(Application $app) {
        return $app
            ->make(FilesystemManager::class)
            ->disk('local');
    }
);
                                </code>
                            </pre>
                        </div>
                        <aside class="notes">
                        </aside>
                    </section>
                    <section class="left invert">
                        <h1 class="highlight"><span>Contextual Binding</span></h1>
                        <div class="relative">
                            <pre style="font-size: 1.5rem" class="absolute">
                                <code class="php" data-line-numbers="">//...
use App\Http\Controllers\Api\User;

$this->app
     ->when(User\UploadProfilePicture::class)
     ->needs(Filesystem::class),
     ->give(function(Application $app) {
        return $app
            ->make(FilesystemManager::class)
            ->disk('local');
     });
                                </code>
                            </pre>
                            <pre style="font-size: 1.5rem" class="fragment fade-in absolute">
                                <code class="php" data-line-numbers="5">//...
use App\Http\Controllers\Api\User;

$this->app
     ->when(User\UploadProfilePicture::class)
     ->needs(Filesystem::class),
     ->give(function(Application $app) {
        return $app
            ->make(FilesystemManager::class)
            ->disk('local');
     });
                                </code>
                            </pre>
                            <pre style="font-size: 1.5rem" class="fragment fade-in absolute">
                                <code class="php" data-line-numbers="6">//...
use App\Http\Controllers\Api\User;

$this->app
     ->when(User\UploadProfilePicture::class)
     ->needs(Filesystem::class),
     ->give(function(Application $app) {
        return $app
            ->make(FilesystemManager::class)
            ->disk('local');
     });
                                </code>
                            </pre>
                            <pre style="font-size: 1.5rem" class="fragment fade-in absolute">
                                <code class="php" data-line-numbers="7-11">//...
use App\Http\Controllers\Api\User;

$this->app
     ->when(User\UploadProfilePicture::class)
     ->needs(Filesystem::class),
     ->give(function(Application $app) {
        return $app
            ->make(FilesystemManager::class)
            ->disk('local');
     });
                                </code>
                            </pre>
                        </div>
                        <aside class="notes">
                        </aside>
                    </section>
                    <section class="left invert" data-background-image="img/unplug.jpg">
                        <h1 class="highlight"><span>Valider en amont de l'action</span></h1>
                        <p class="highlight"><span class="fragment">ArrÃªter le processus le plus tÃ´t possibleâ€¦</span></p>
                        <p class="highlight right"><span class="fragment">â€¦ <code>Middlewares</code> et <code>FormRequest</code>.</span></p>
                        <aside class="notes">
                        </aside>
                    </section>
                    <section class="left invert" data-background-image="img/layers.jpg">
                        <h1 class="highlight"><span>Middlewares ?</span></h1>
                        <aside class="notes">
                        </aside>
                    </section>
                    <section class="left invert">
                        <h1 class="highlight"><span>FormRequest</span></h1>
                        <pre style="font-size: 1.4rem"><code class="bash">./artisan make:request UploadUserProfile</code></pre>
                        <pre style="font-size: 1.4rem;"><code class="php" data-line-numbers>namespace App\Http\Requests;

use Illuminate\Foundation\Http\FormRequest;
use Illuminate\Http\UploadedFile;

class UploadUserProfile extends FormRequest
{
    public function rules() {
        return ['image' => 'required|image'];
    }

    public function image(): UploadedFile {
        return $this->validated()['image'];
    }
}
                        </code></pre>
                        <aside class="notes">
                        </aside>
                    </section>
                    <section class="left invert">
                        <h1 class="highlight"><span>Modification du contrÃ´leur</span></h1>
                        <div class="relative">
                            <pre style="font-size: 1.25rem" class="absolute">
                                <code class="php" data-line-numbers>namespace App\Http\Controllers\Api\User;

use App\Http\Requests\UploadUserProfile;

class UploadProfilePicture
{
    public function __construct(Filesystem $filesystem)
    {
        $this->filesystem = $filesystem;
    }

    public function __invoke(UploadUserProfile $request)
    {
        $image = $request->image();
        $this->filesystem->put('images', $image);
    }
}
                                </code>
                            </pre>
                            <pre style="font-size: 1.25rem" class="fragment absolute fade-in">
                                <code class="php" data-line-numbers="3,12,14">namespace App\Http\Controllers\Api\User;

use App\Http\Requests\UploadUserProfile;

class UploadProfilePicture
{
    public function __construct(Filesystem $filesystem)
    {
        $this->filesystem = $filesystem;
    }

    public function __invoke(UploadUserProfile $request)
    {
        $image = $request->image();
        $this->filesystem->put('images', $image);
    }
}
                                </code>
                            </pre>
                        </div>
                    </section>
                </section>
                <section class="stack">
                    <section data-background-image="img/conclusion.jpg" class="left invert" style="margin-top: -10%">
                        <h1 class="highlight"><span>Au finalâ€¦</span></h1>
                        <p class="highlight">
                            <span class="fragment">â–¶ Laravel est un outil et seulement un outil.</span><br/>
                            <span class="fragment">â–¶ TrÃ¨s rapide pour prototyper.</span><br/>
                            <span class="fragment">â–¶ TrÃ¨s riche en fonctionnalitÃ©s par dÃ©faut.</span>
                        </p>
                        <aside class="notes"></aside>
                    </section>
                    <section data-background-image="img/danger.jpg" class="left invert">
                        <h1 class="highlight bottom "><span>Attention Ã â€¦</span></h1>
                        <p class="highlight">
                            <span class="fragment">â–¶ Ne pas prendre tout les raccourcis possible.</span><br/>
                            <span class="fragment">â–¶ Prendre le temps d'apprendre.</span><br/>
                            <span class="fragment">â–¶ RÃ©flÃ©chir au projet dans son ensemble.</span><br/>
                            <span class="fragment">â–¶ Comprendre l'architecture de votre code.</span>
                        </p>
                        <aside class="notes"></aside>
                    </section>
                </section>
<!--#########################################################################-->
                <section class="invert" data-background-image="img/thank-you.jpg">
                    <p class="right">
                        <img class="plain" width="200" src="img/joindin.png" />
                    </p>
                    <p class="right highlight">
                        <span><a href="https://joind.in/talk/a77e5">https://joind.in/talk/a77e5</a></span>
                    </p>
                    <aside class="notes">
                        Merci de votre attention.
                    </aside>
                </section>
            </div>
        </div>

        <script src="../assets/reveal.js/js/reveal.js"></script>
        <script src="../assets/javascripts/mermaid.min.js"></script>

        <script>
            // Full list of configuration options available here:
            // https://github.com/hakimel/reveal.js#configuration
            Reveal.initialize({
                controls: false,
                progress: true,
                history: true,
                center: true,

                theme: Reveal.getQueryHash().theme, // available themes are in /css/theme
                transition: Reveal.getQueryHash().transition || 'default', // default/cube/page/concave/zoom/linear/fade/none

                // Optional libraries used to extend on reveal.js
                dependencies: [
                    { src: '../assets/reveal.js/lib/js/classList.js', condition: function() { return !document.body.classList; } },
                    { src: '../assets/reveal.js/plugin/markdown/marked.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
                    { src: '../assets/reveal.js/plugin/markdown/markdown.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
                    { src: '../assets/reveal.js/plugin/highlight/highlight.js', async: true, callback: function() { hljs.initHighlightingOnLoad(); } },
                    { src: '../assets/reveal.js/plugin/zoom-js/zoom.js', async: true },
                    { src: '../assets/reveal.js/plugin/notes/notes.js', async: true }
                ]
            });

            mermaid.initialize({startOnLoad:true});
        </script>
    </body>
</html>
